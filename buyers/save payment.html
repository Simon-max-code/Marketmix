<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saved Payments - MarketMix</title>
<style>
  :root {
    --bg-light:  #FFF7ED;
    --bg-dark: #1f1f1f;
    --text-light: #333;
    --text-dark: #f4f4f4;
    --card-light: #fef8f3;
    --card-dark: #2c2c2c;
    --accent: #ffe800;
  }
  body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background-color: var(--bg-light);
    color: var(--text-light);
    transition: background 0.3s ease, color 0.3s ease;
  }
  
  .navbar {
    background: white;
    padding: 10px 20px;
    max-width: 900px;
    margin: 15px auto;
    border-radius: 50px;
    box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  body.dark .navbar {
    background: var(--card-dark);
  }
  .navbar h1 {
    font-size: 18px;
    margin: 0;
  }
  .toggle-mode {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 16px;
  }
  .container {
    max-width: 900px;
    margin: auto;
    padding: 20px;
  }
  h2 {
    text-align: center;
    margin-bottom: 25px;
  }
  .payment-method {
    background: var(--card-light);
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    padding: 20px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    flex-wrap: wrap;
    transition: background 0.3s ease;
  }
  body.dark .payment-method {
    background: var(--card-dark);
  }
  .payment-details {
    flex: 1 1 70%;
    display: flex;
    align-items: center;
    gap: 15px;
  }
  .payment-details img {
    width: 50px;
    height: auto;
  }
  .payment-text p {
    margin: 3px 0;
  }
  .tags {
    display: inline-block;
    background: var(--accent);
    color: #333;
    font-size: 12px;
    padding: 2px 6px;
    border-radius: 4px;
    margin-left: 5px;
  }
  .actions {
    flex: 1 1 25%;
    text-align: right;
  }
  .btn {
    padding: 6px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    margin-left: 5px;
    margin-top: 5px;
  }
  .btn-edit { background-color: var(--accent); color: #333; }
  .btn-delete { background-color: #e74c3c; color: white; }
  .addPaymentBtn {
    background-color: #333;
    color: white;
    padding: 10px 15px;
    margin: 20px 0;
    display: inline-block;
    border-radius: 8px;
    text-decoration: none;
  }
  .addPaymentBtn:hover { background-color: #555; }
  .expand {
    margin-top: 10px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease;
  }
  .expand.show { max-height: 200px; }
  /* Overlay */
  .overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(2px);
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease forwards;
    z-index: 999;
  }
  .overlay.show { display: flex; }
  /* Modal for Add/Edit */
  .modal {
    background: white;
    padding: 20px;
    border-radius: 10px;
    min-width: 320px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    animation: scaleIn 0.3s ease forwards;
  }
  body.dark .modal {
    background: var(--card-dark);
    color: white;
  }
  /* Animations */
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  @keyframes scaleIn { from { transform: scale(0.9); } to { transform: scale(1); } }
  /* Form */
  .modal form label {
    display: block;
    margin: 10px 0 5px;
    font-size: 14px;
  }
  .modal form input, 
  .modal form select {
    width: 100%;
    padding: 8px;
    margin-bottom: 8px;
    border: 1px solid #ccc;
    border-radius: 5px;
  }
  body.dark .modal form input,
  body.dark .modal form select {
    background: #444;
    color: white;
    border: 1px solid #666;
  }
  .modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 10px;
  }
  .modal-buttons button {
    padding: 8px 12px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  .btn-cancel { background: #bbb; }
  .btn-save { background: var(--accent); color: #333; }
  footer {
    text-align: center;
    padding: 15px;
    background-color: #f0f0f0;
    color: #555;
    font-size: 14px;
    margin-top: 30px;
  }
</style>
</head>
<body>

<div class="navbar">
  <h1>MarketMix Payments</h1>

</div>

<div class="container">
  <h2>ðŸ’³ Saved Payment Methods</h2>

  <div class="payment-method">
    <div class="payment-details">
      <img src="https://upload.wikimedia.org/wikipedia/commons/0/04/Visa.svg" alt="Visa">
      <div class="payment-text">
        <p><strong>Card:</strong> **** **** **** 1234 <span class="tags">Default</span></p>
        <p><strong>Name:</strong> Sarah Johnson</p>
        <p><strong>Expiry:</strong> 08/27</p>
        <div class="expand">
          <p>Billing Address: 123 Main St, Lagos</p>
          <p>Added on: Jan 10, 2025</p>
        </div>
      </div>
    </div>
    <div class="actions">
      <button class="btn btn-edit" onclick="toggleExpand(this)">Details</button>
      <button class="btn btn-edit" onclick="editPayment(this)">Edit</button>

      <button class="btn btn-delete" onclick="confirmDelete(this)">Delete</button>
    </div>
  </div>

  <div class="payment-method">
    <div class="payment-details">
      <img src="https://upload.wikimedia.org/wikipedia/commons/0/0c/Mastercard-logo.png" alt="MasterCard">
      <div class="payment-text">
        <p><strong>Bank Transfer:</strong> Zenith Bank (****8901)</p>
        <p><strong>Name:</strong> Sarah Johnson</p>
        <p><strong>Account Type:</strong> Savings</p>
        <div class="expand">
          <p>Branch: Victoria Island</p>
          <p>Added on: Feb 5, 2025</p>
        </div>
      </div>
    </div>
    <div class="actions">
      <button class="btn btn-edit" onclick="toggleExpand(this)">Details</button>
  <button class="btn btn-edit" onclick="editPayment(this)">Edit</button>

      <button class="btn btn-delete" onclick="confirmDelete(this)">Delete</button>
    </div>
  </div>

  <a href="#" id="addPaymentBtn" class="addPaymentBtn">+ Add New Payment Method</a>
</div>

<!-- Add Payment Overlay -->
<div class="overlay" id="paymentOverlay">
  <div class="modal">
    <h3 id="modalTitle">Add New Payment Method</h3>
    <form id="paymentForm">
      <label>Payment Type:</label>
      <select id="paymentType" required>
        <option value="">Select</option>
        <option value="Card">Card</option>
        <option value="Bank">Bank Transfer</option>
      </select>

      <label id="numberLabel">Card Number:</label>
      <input type="text" id="paymentNumber" placeholder="Enter card/account number" required>

      <label>Name:</label>
      <input type="text" id="paymentName" placeholder="Name on card/account" required>

      <label id="extraLabel">Expiry:</label>
      <input type="text" id="extraField" placeholder="MM/YY or Account Type" required>

      <div class="modal-buttons">
        <button type="button" class="btn-cancel" id="cancelPayment">Cancel</button>
        <button type="submit" class="btn-save">Save</button>
      </div>
    </form>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="overlay" id="deleteModal">
  <div class="modal">
    <p>Are you sure you want to delete this payment method?</p>
    <div class="modal-buttons">
      <button class="btn btn-delete" onclick="deleteConfirmed()">Yes, Delete</button>
      <button class="btn btn-edit" onclick="closeModal()">Cancel</button>
    </div>
  </div>
</div>

<footer>
  &copy; 2025 MarketMix - All rights reserved.
</footer>
<script>


  function toggleExpand(btn) {
    const expand = btn.closest('.payment-method').querySelector('.expand');
    expand.classList.toggle('show');
  }

  let toDelete = null;
  let editingCard = null;

  function confirmDelete(btn) {
    toDelete = btn.closest('.payment-method');
    document.getElementById('deleteModal').classList.add('show');
  }
  function closeModal() {
    document.getElementById('deleteModal').classList.remove('show');
  }
  function deleteConfirmed() {
    if (toDelete) {
      toDelete.remove();
      toDelete = null;
    }
    closeModal();
  }

  const addPaymentBtn = document.getElementById('addPaymentBtn');
  const paymentOverlay = document.getElementById('paymentOverlay');
  const cancelPayment = document.getElementById('cancelPayment');
  const paymentType = document.getElementById('paymentType');
  const numberLabel = document.getElementById('numberLabel');
  const extraLabel = document.getElementById('extraLabel');
  const paymentForm = document.getElementById('paymentForm');
  const modalTitle = document.getElementById('modalTitle');

  // Open Add Payment modal
  addPaymentBtn.addEventListener('click', e => {
    e.preventDefault();
    editingCard = null;
    modalTitle.textContent = "Add New Payment Method";
    paymentOverlay.classList.add('show');
    paymentForm.reset();
  });

  // Cancel button
  cancelPayment.addEventListener('click', () => {
    paymentOverlay.classList.remove('show');
    paymentForm.reset();
  });

  // Close modal when clicking outside
  paymentOverlay.addEventListener('click', e => {
    if (e.target === paymentOverlay) {
      paymentOverlay.classList.remove('show');
      paymentForm.reset();
    }
  });

  // Change labels depending on type
  paymentType.addEventListener('change', () => {
    if (paymentType.value === 'Card') {
      numberLabel.innerText = "Card Number:";
      extraLabel.innerText = "Expiry:";
    } else {
      numberLabel.innerText = "Account Number:";
      extraLabel.innerText = "Account Type:";
    }
  });

  // Handle Add/Edit submit
  paymentForm.addEventListener('submit', e => {
    e.preventDefault();

    const type = paymentType.value;
    const number = document.getElementById('paymentNumber').value.trim();
    const name = document.getElementById('paymentName').value.trim();
    const extra = document.getElementById('extraField').value.trim();
    const today = new Date().toLocaleDateString();

    let maskedNumber = "";
    let imgSrc = "";
    let extraLabelText = "";
    let expandInfo = "";

    if (type === "Card") {
      maskedNumber = "**** **** **** " + number.slice(-4);
      imgSrc = "https://upload.wikimedia.org/wikipedia/commons/0/04/Visa.svg"; 
      extraLabelText = `<p><strong>Expiry:</strong> ${extra}</p>`;
      expandInfo = `<p>Billing Address: Not provided</p><p>Added on: ${today}</p>`;
    } else {
      maskedNumber = `(${ "****" + number.slice(-4) })`;
      imgSrc = "https://upload.wikimedia.org/wikipedia/commons/0/0c/Mastercard-logo.png"; 
      extraLabelText = `<p><strong>Account Type:</strong> ${extra}</p>`;
      expandInfo = `<p>Branch: Not provided</p><p>Added on: ${today}</p>`;
    }

    if (editingCard) {
      // Update existing card
      const img = editingCard.querySelector("img");
      img.src = imgSrc;
      img.alt = type;

      const paymentText = editingCard.querySelector(".payment-text");
      paymentText.innerHTML = `
        <p><strong>${type}:</strong> ${maskedNumber}</p>
        <p><strong>Name:</strong> ${name}</p>
        ${extraLabelText}
        <div class="expand">
          ${expandInfo}
        </div>
      `;
      editingCard = null;
    } else {
      // Create new card
      const newCard = document.createElement('div');
      newCard.className = "payment-method";
      newCard.innerHTML = `
        <div class="payment-details">
          <img src="${imgSrc}" alt="${type}">
          <div class="payment-text">
            <p><strong>${type}:</strong> ${maskedNumber}</p>
            <p><strong>Name:</strong> ${name}</p>
            ${extraLabelText}
            <div class="expand">
              ${expandInfo}
            </div>
          </div>
        </div>
        <div class="actions">
          <button class="btn btn-edit" onclick="toggleExpand(this)">Details</button>
          <button class="btn btn-edit" onclick="editPayment(this)">Edit</button>
          <button class="btn btn-delete" onclick="confirmDelete(this)">Delete</button>
        </div>
      `;
      document.querySelector('.container').insertBefore(newCard, addPaymentBtn);
    }

    paymentOverlay.classList.remove('show');
    paymentForm.reset();
  });

  // Edit payment method
  window.editPayment = function(btn) {
    editingCard = btn.closest('.payment-method');
    modalTitle.textContent = "Edit Payment Method";

    const typeText = editingCard.querySelector('.payment-text p strong').textContent;
    if (typeText.includes("Card")) {
      paymentType.value = "Card";
      numberLabel.innerText = "Card Number:";
      extraLabel.innerText = "Expiry:";
    } else {
      paymentType.value = "Bank";
      numberLabel.innerText = "Account Number:";
      extraLabel.innerText = "Account Type:";
    }

    const masked = editingCard.querySelector('.payment-text p').textContent;
    const last4 = masked.match(/(\d{4})$/) ? masked.match(/(\d{4})$/)[0] : "";
    document.getElementById('paymentNumber').value = last4;
    document.getElementById('paymentName').value = editingCard.querySelectorAll('.payment-text p')[1].textContent.replace("Name:", "").trim();
    document.getElementById('extraField').value = editingCard.querySelectorAll('.payment-text p')[2].textContent.split(":")[1].trim();

    paymentOverlay.classList.add('show');
  }
</script>

</body>
</html>
